---
# System optimization configuration

# Kernel parameters
kernel_params:
  # Network performance
  net.core.somaxconn: 32768
  net.core.netdev_max_backlog: 16384
  net.ipv4.tcp_max_syn_backlog: 8096
  net.ipv4.tcp_slow_start_after_idle: 0
  net.ipv4.tcp_tw_reuse: 1
  net.ipv4.ip_local_port_range: "1024 65535"
  net.ipv4.tcp_fin_timeout: 30
  
  # Memory management
  vm.swappiness: 1
  vm.dirty_ratio: 10
  vm.dirty_background_ratio: 5
  vm.vfs_cache_pressure: 50
  vm.min_free_kbytes: 131072
  
  # Kubernetes specific
  net.bridge.bridge-nf-call-iptables: 1
  net.bridge.bridge-nf-call-ip6tables: 1
  net.ipv4.ip_forward: 1
  
  # File descriptors
  fs.file-max: 2097152
  fs.inotify.max_user_watches: 524288
  fs.inotify.max_user_instances: 512
  
  # Connection tracking moved to kernel_security role
  # net.netfilter.nf_conntrack_max: 1048576  # <- REMOVED to avoid conflict

# Zram configuration
zram_size_mb: 768
zram_compression: lz4

# System limits
system_nofile_soft: 65536
system_nofile_hard: 65536
system_nproc_soft: 32768
system_nproc_hard: 32768