# Ansible K3s Optimization

üöÄ **Production-ready Ansible playbooks** –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ K3s –∫–ª–∞—Å—Ç–µ—Ä–∞, security hardening, honeypot deployment, –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏.

---

## üìä K3s Cluster Audit & –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Audit –°–∫—Ä–∏–ø—Ç

–ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç master-–Ω–æ–¥—ã K3s –∫–ª–∞—Å—Ç–µ—Ä–∞ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç.

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
ansible-playbook playbooks/setup-k3s-audit.yml
# –∏–ª–∏
make install-audit
```

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –Ω–∞ –Ω–æ–¥–µ
sudo k3s-cluster-audit
# –∏–ª–∏
sudo k3s-audit

# –ß–µ—Ä–µ–∑ Ansible
make run-audit
```

#### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ cron-–æ–º.
–û—Ç—á–µ—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `/var/log/k3s-audit/` —Å —Ä–æ—Ç–∞—Ü–∏–µ–π –Ω–∞ 30 –¥–Ω–µ–π.

### –ü–æ–∫–∞–∑ –ø–æ–ª–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

Playbook –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–ª–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ K3s-–Ω–æ–¥—ã.

#### –ó–∞–ø—É—Å–∫

```bash
# –¢–æ–ª—å–∫–æ –ø–æ–∫–∞–∑
ansible-playbook playbooks/show-node-config.yml
# –ü–æ–∫–∞–∑ + —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
ansible-playbook playbooks/show-node-config.yml -e "save_to_file=true"

# –ß–µ—Ä–µ–∑ Makefile
make show-config       # —Ç–æ–ª—å–∫–æ –ø–æ–∫–∞–∑
make show-config-save  # –ø–æ–∫–∞–∑ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
```

#### –ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç

1. **–°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è**: –û–°, kernel, CPU, RAM, IP, –∞–ø—Ç–∞–π–º
2. **K3s –∫–æ–Ω—Ñ–∏–≥**: –≤–µ—Ä—Å–∏—è, config.yaml, —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞ –∏ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∑–∞–ø—É—Å–∫–∞
3. **Kubernetes –∫–ª–∞—Å—Ç–µ—Ä**: –Ω–æ–¥—ã, –ø–æ–¥—ã, —Å–µ—Ä–≤–∏—Å—ã, namespaces, —Å–æ—Å—Ç–æ—è–Ω–∏–µ
4. **–°–µ—Ç—å**: –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã, –º–∞—Ä—à—Ä—É—Ç—ã, –ø–æ—Ä—Ç—ã, iptables, sysctl
5. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: fail2ban, UFW, PSAD, honeypot
6. **–°—Ö–æ–≤–∏—â–µ**: –¥–∏—Å–∫–∏, PV, PVC, StorageClasses
7. **–†–µ—Å—É—Ä—Å—ã**: CPU, RAM, top –ø—Ä–æ—Ü–µ—Å—Å—ã, –º–µ—Ç—Ä–∏–∫–∏
8. **–û—Ç—á–µ—Ç**: —ç–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –≤ YAML-—Ñ–∞–π–ª

---

–í—Å–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –≤–Ω–µ—Å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π. –¢–µ–ø–µ—Ä—å –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç–µ –æ—Ç–≤–µ—Ç—ã –±—É–¥—É—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.

---

(–û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–µ–∫—Ü–∏–∏ README –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
